---
description: md-open CLIツールの要件定義
---
# md-open CLI

マークダウンファイルをブラウザでプレビューするCLIツール。複数ファイルを指定し、左側のファイルリストから選択して表示を切り替えられる。

関連: [design](design.md)

## EARS記法パターン

| パターン | 構文 | 用途 |
|---------|------|------|
| Event-Driven | When [イベント], the [システム] shall [アクション] | イベント発生時の動作 |
| State-Driven | While [状態], the [システム] shall [アクション] | 特定状態中の動作 |
| Unwanted | If [トリガー], the [システム] shall [アクション] | 異常系・エラー処理 |
| Optional | Where [機能], the [システム] shall [アクション] | オプション機能 |
| Ubiquitous | The [システム] shall [アクション] | 常に適用される動作 |

## 1. CLIコマンド実行

**目的**: ユーザーとして、コマンドラインからマークダウンファイルを指定してプレビューしたい。それにより、ターミナルから素早くドキュメントを確認できる。

### 受け入れ基準

1.1 When `md-open file1.md file2.md ...` コマンドが実行された場合, the システムは指定された全てのマークダウンファイルをプレビュー対象として登録するものとする

1.2 When コマンドがファイル引数なしで実行された場合, the システムはヘルプメッセージを表示して終了するものとする

1.3 When `--help` または `-h` オプションが指定された場合, the システムは使用方法とオプション一覧を表示して終了するものとする

1.4 When `--version` または `-v` オプションが指定された場合, the システムはバージョン情報を表示して終了するものとする

1.5 When `--port <number>` オプションが指定された場合, the システムは指定されたポート番号でサーバーを起動するものとする

1.6 When `--no-open` オプションが指定された場合, the システムはブラウザを自動で開かないものとする

1.7 If 指定されたファイルが存在しない場合, the システムはエラーメッセージを表示し、存在しないファイルをスキップして処理を継続するものとする

1.8 If 全ての指定ファイルが存在しない場合, the システムはエラーメッセージを表示して終了するものとする

## 2. HTTPサーバー

**目的**: ユーザーとして、ローカルサーバー経由でマークダウンをブラウザで閲覧したい。それにより、リッチなレンダリング結果を確認できる。

### 受け入れ基準

2.1 When サーバーが起動された場合, the システムはデフォルトポート3000でHTTPサーバーを開始するものとする

2.2 If デフォルトポート3000が使用中の場合, the システムはポート番号を+1してリトライし、利用可能なポートでサーバーを起動するものとする

2.3 When サーバーが正常に起動した場合, the システムはサーバーURLをコンソールに表示するものとする

2.4 When サーバーが正常に起動した場合, the システムはデフォルトブラウザでプレビューページを開くものとする（`--no-open`指定時を除く）

2.5 When `Ctrl+C` が押された場合, the システムはサーバーを停止してプロセスを終了するものとする

2.6 The システムは静的ファイル（HTML、CSS、JavaScript）を配信するものとする

## 3. ファイルリスト表示

**目的**: ユーザーとして、複数のマークダウンファイルを切り替えて閲覧したい。それにより、関連するドキュメントを効率的に確認できる。

### 受け入れ基準

3.1 The システムは画面左側に指定されたマークダウンファイルのリストを表示するものとする

3.2 When ファイルリストの項目がクリックされた場合, the システムは選択されたファイルの内容を右側のプレビュー領域に表示するものとする

3.3 The システムは現在表示中のファイルをハイライト表示するものとする

3.4 When サーバーが起動された場合, the システムはリストの最初のファイルを初期表示するものとする

3.5 The システムはファイル名のみをリストに表示するものとする（フルパスではなく）

## 4. API

**目的**: フロントエンドとして、バックエンドからファイル情報とコンテンツを取得したい。それにより、動的にファイル内容を表示できる。

### 受け入れ基準

4.1 When `GET /api/files` リクエストが送信された場合, the システムは登録されたファイルのリスト（ファイル名とパス）をJSON形式で返すものとする

4.2 When `GET /api/files/:filename` リクエストが送信された場合, the システムは指定されたファイルのマークダウンコンテンツを返すものとする

4.3 If 存在しないファイルが要求された場合, the システムは404ステータスコードを返すものとする
